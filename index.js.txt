this the high level code